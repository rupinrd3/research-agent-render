<svg width="1200" height="400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 400">
  <!-- Define gradients and filters -->
  <defs>
    <!-- Gradient for completed state -->
    <linearGradient id="completedGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10B981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>

    <!-- Gradient for active state with animation -->
    <linearGradient id="activeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#6366F1;stop-opacity:1">
        <animate attributeName="stop-color" values="#6366F1;#8B5CF6;#6366F1" dur="2s" repeatCount="indefinite"/>
      </stop>
      <stop offset="100%" style="stop-color:#4F46E5;stop-opacity:1">
        <animate attributeName="stop-color" values="#4F46E5;#7C3AED;#4F46E5" dur="2s" repeatCount="indefinite"/>
      </stop>
    </linearGradient>

    <!-- Gradient for pending state -->
    <linearGradient id="pendingGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#E5E7EB;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#D1D5DB;stop-opacity:1" />
    </linearGradient>

    <!-- Glow filter for active node -->
    <filter id="glow">
      <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>

    <!-- Drop shadow for nodes -->
    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>

    <!-- Animated dash pattern for active connections -->
    <linearGradient id="flowGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#6366F1;stop-opacity:0">
        <animate attributeName="offset" values="0;1" dur="1.5s" repeatCount="indefinite"/>
      </stop>
      <stop offset="50%" style="stop-color:#6366F1;stop-opacity:1">
        <animate attributeName="offset" values="0.5;1.5" dur="1.5s" repeatCount="indefinite"/>
      </stop>
      <stop offset="100%" style="stop-color:#6366F1;stop-opacity:0">
        <animate attributeName="offset" values="1;2" dur="1.5s" repeatCount="indefinite"/>
      </stop>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="1200" height="400" fill="#F9FAFB"/>

  <!-- Title -->
  <text x="600" y="30" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1F2937" text-anchor="middle">
    Research Agent Workflow - ReAct Pattern
  </text>

  <!-- Iteration Counter Badge (top right) -->
  <g transform="translate(1050, 60)">
    <rect x="-60" y="-20" width="120" height="40" rx="20" fill="url(#activeGradient)" filter="url(#shadow)"/>
    <text x="0" y="-2" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle" font-weight="bold">
      ITERATION
    </text>
    <text x="0" y="12" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle" font-weight="bold">
      3 / 10
    </text>
  </g>

  <!-- ============== WORKFLOW NODES ============== -->

  <!-- Node positions -->
  <!-- Start: 100, Think: 250, Act: 400, Execute: 550, Observe: 700, Evaluate: 850, Finish: 1000 -->

  <!-- 1. START NODE (Completed) -->
  <g transform="translate(100, 200)">
    <circle r="35" fill="url(#completedGradient)" filter="url(#shadow)"/>
    <circle r="30" fill="white" opacity="0.2"/>
    <!-- Checkmark icon -->
    <path d="M -8 0 L -3 8 L 12 -8" stroke="white" stroke-width="3" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    <text y="55" font-family="Arial, sans-serif" font-size="12" fill="#374151" text-anchor="middle" font-weight="600">Start</text>
    <text y="70" font-family="Arial, sans-serif" font-size="10" fill="#6B7280" text-anchor="middle">Query Received</text>
  </g>

  <!-- Connection: Start -> Think (Completed) -->
  <line x1="135" y1="200" x2="215" y2="200" stroke="#10B981" stroke-width="3" stroke-linecap="round"/>
  <polygon points="215,200 207,196 207,204" fill="#10B981"/>

  <!-- 2. THINK NODE (Completed) -->
  <g transform="translate(250, 200)">
    <circle r="35" fill="url(#completedGradient)" filter="url(#shadow)"/>
    <circle r="30" fill="white" opacity="0.2"/>
    <!-- Brain icon (simplified) -->
    <path d="M -10 -5 Q -10 -15 0 -15 Q 10 -15 10 -5 Q 10 5 5 8 L 5 12 L -5 12 L -5 8 Q -10 5 -10 -5 M -5 -8 L -5 0 M 0 -10 L 0 2 M 5 -8 L 5 0"
          stroke="white" stroke-width="2" fill="none" stroke-linecap="round"/>
    <text y="55" font-family="Arial, sans-serif" font-size="12" fill="#374151" text-anchor="middle" font-weight="600">Think</text>
    <text y="70" font-family="Arial, sans-serif" font-size="10" fill="#6B7280" text-anchor="middle">Reasoning</text>
  </g>

  <!-- Connection: Think -> Act (Completed) -->
  <line x1="285" y1="200" x2="365" y2="200" stroke="#10B981" stroke-width="3" stroke-linecap="round"/>
  <polygon points="365,200 357,196 357,204" fill="#10B981"/>

  <!-- 3. ACT NODE (Completed) -->
  <g transform="translate(400, 200)">
    <circle r="35" fill="url(#completedGradient)" filter="url(#shadow)"/>
    <circle r="30" fill="white" opacity="0.2"/>
    <!-- Tool selection icon -->
    <rect x="-8" y="-12" width="16" height="4" fill="white" rx="1"/>
    <rect x="-8" y="-4" width="16" height="4" fill="white" rx="1"/>
    <rect x="-8" y="4" width="16" height="4" fill="white" rx="1"/>
    <circle cx="10" cy="-10" r="2" fill="white"/>
    <text y="55" font-family="Arial, sans-serif" font-size="12" fill="#374151" text-anchor="middle" font-weight="600">Act</text>
    <text y="70" font-family="Arial, sans-serif" font-size="10" fill="#6B7280" text-anchor="middle">Select Tool</text>
  </g>

  <!-- Connection: Act -> Execute (Active with animation) -->
  <line x1="435" y1="200" x2="515" y2="200" stroke="#E5E7EB" stroke-width="3" stroke-linecap="round"/>
  <line x1="435" y1="200" x2="515" y2="200" stroke="url(#flowGradient)" stroke-width="3" stroke-linecap="round">
    <animate attributeName="stroke-dasharray" values="0 80;80 0" dur="1.5s" repeatCount="indefinite"/>
  </line>
  <polygon points="515,200 507,196 507,204" fill="#6366F1">
    <animate attributeName="opacity" values="0.5;1;0.5" dur="1s" repeatCount="indefinite"/>
  </polygon>

  <!-- 4. EXECUTE NODE (Active) -->
  <g transform="translate(550, 200)">
    <circle r="35" fill="url(#activeGradient)" filter="url(#glow)">
      <animate attributeName="r" values="35;38;35" dur="2s" repeatCount="indefinite"/>
    </circle>
    <circle r="30" fill="white" opacity="0.3">
      <animate attributeName="opacity" values="0.2;0.4;0.2" dur="2s" repeatCount="indefinite"/>
    </circle>
    <!-- Gear icon with rotation -->
    <g>
      <animateTransform attributeName="transform" type="rotate" from="0 0 0" to="360 0 0" dur="3s" repeatCount="indefinite"/>
      <circle r="8" fill="none" stroke="white" stroke-width="2"/>
      <rect x="-2" y="-12" width="4" height="4" fill="white"/>
      <rect x="-2" y="8" width="4" height="4" fill="white"/>
      <rect x="-12" y="-2" width="4" height="4" fill="white"/>
      <rect x="8" y="-2" width="4" height="4" fill="white"/>
    </g>
    <text y="55" font-family="Arial, sans-serif" font-size="12" fill="#374151" text-anchor="middle" font-weight="600">Execute</text>
    <text y="70" font-family="Arial, sans-serif" font-size="10" fill="#6366F1" text-anchor="middle" font-weight="600">Running...</text>
    <!-- Tool name badge -->
    <rect x="-35" y="-55" width="70" height="20" rx="10" fill="#6366F1" opacity="0.9"/>
    <text y="-41" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle" font-weight="600">web_search</text>
  </g>

  <!-- Connection: Execute -> Observe (Pending) -->
  <line x1="585" y1="200" x2="665" y2="200" stroke="#D1D5DB" stroke-width="3" stroke-linecap="round" stroke-dasharray="5,5"/>
  <polygon points="665,200 657,196 657,204" fill="#D1D5DB"/>

  <!-- 5. OBSERVE NODE (Pending) -->
  <g transform="translate(700, 200)">
    <circle r="35" fill="url(#pendingGradient)" filter="url(#shadow)"/>
    <!-- Eye icon -->
    <ellipse cx="0" cy="0" rx="12" ry="8" fill="none" stroke="#9CA3AF" stroke-width="2"/>
    <circle cx="0" cy="0" r="4" fill="#9CA3AF"/>
    <text y="55" font-family="Arial, sans-serif" font-size="12" fill="#9CA3AF" text-anchor="middle" font-weight="600">Observe</text>
    <text y="70" font-family="Arial, sans-serif" font-size="10" fill="#9CA3AF" text-anchor="middle">Analyze Results</text>
  </g>

  <!-- Connection: Observe -> Evaluate (Pending) -->
  <line x1="735" y1="200" x2="815" y2="200" stroke="#D1D5DB" stroke-width="3" stroke-linecap="round" stroke-dasharray="5,5"/>
  <polygon points="815,200 807,196 807,204" fill="#D1D5DB"/>

  <!-- 6. EVALUATE NODE (Pending - Decision Point) -->
  <g transform="translate(850, 200)">
    <circle r="35" fill="url(#pendingGradient)" filter="url(#shadow)"/>
    <!-- Diamond/Decision icon -->
    <path d="M 0 -12 L 10 0 L 0 12 L -10 0 Z" fill="none" stroke="#9CA3AF" stroke-width="2"/>
    <text y="55" font-family="Arial, sans-serif" font-size="12" fill="#9CA3AF" text-anchor="middle" font-weight="600">Evaluate</text>
    <text y="70" font-family="Arial, sans-serif" font-size="10" fill="#9CA3AF" text-anchor="middle">Decision Point</text>
  </g>

  <!-- Connection: Evaluate -> Finish (Pending) -->
  <line x1="885" y1="200" x2="965" y2="200" stroke="#D1D5DB" stroke-width="3" stroke-linecap="round" stroke-dasharray="5,5"/>
  <polygon points="965,200 957,196 957,204" fill="#D1D5DB"/>

  <!-- 7. FINISH NODE (Pending) -->
  <g transform="translate(1000, 200)">
    <circle r="35" fill="url(#pendingGradient)" filter="url(#shadow)"/>
    <!-- Flag icon -->
    <path d="M -8 -10 L -8 12 M -8 -10 L 8 -5 L -8 0" fill="#9CA3AF" stroke="#9CA3AF" stroke-width="2"/>
    <text y="55" font-family="Arial, sans-serif" font-size="12" fill="#9CA3AF" text-anchor="middle" font-weight="600">Finish</text>
    <text y="70" font-family="Arial, sans-serif" font-size="10" fill="#9CA3AF" text-anchor="middle">Final Report</text>
  </g>

  <!-- ============== LOOPBACK ARC ============== -->
  <!-- Arc from Evaluate back to Think (showing iteration) -->
  <g opacity="0.7">
    <!-- Main loop arc -->
    <path d="M 850 165 Q 550 80 250 165"
          fill="none"
          stroke="#10B981"
          stroke-width="2.5"
          stroke-dasharray="8,4"
          stroke-linecap="round">
      <!-- Animate dash movement -->
      <animate attributeName="stroke-dashoffset" from="0" to="-24" dur="1.5s" repeatCount="indefinite"/>
    </path>
    <!-- Arrow at the end -->
    <polygon points="245,165 250,158 255,165" fill="#10B981" transform="rotate(-45 250 165)"/>

    <!-- Loop label with background -->
    <g transform="translate(550, 100)">
      <rect x="-55" y="-15" width="110" height="28" rx="14" fill="white" filter="url(#shadow)"/>
      <rect x="-55" y="-15" width="110" height="28" rx="14" fill="#10B981" opacity="0.1"/>
      <text y="5" font-family="Arial, sans-serif" font-size="11" fill="#059669" text-anchor="middle" font-weight="600">
        ‚Üª Iterate (3 loops)
      </text>
    </g>

    <!-- Decision labels on the arc -->
    <g transform="translate(850, 140)">
      <text font-family="Arial, sans-serif" font-size="9" fill="#6B7280" text-anchor="middle" font-style="italic">
        Need more info?
      </text>
    </g>
  </g>

  <!-- ============== STATUS LEGEND ============== -->
  <g transform="translate(80, 340)">
    <text font-family="Arial, sans-serif" font-size="12" fill="#374151" font-weight="600">Status:</text>

    <!-- Completed -->
    <circle cx="60" cy="-3" r="8" fill="url(#completedGradient)"/>
    <text x="75" y="1" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">Completed</text>

    <!-- Active -->
    <circle cx="160" cy="-3" r="8" fill="url(#activeGradient)">
      <animate attributeName="r" values="8;10;8" dur="2s" repeatCount="indefinite"/>
    </circle>
    <text x="175" y="1" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">Active</text>

    <!-- Pending -->
    <circle cx="240" cy="-3" r="8" fill="url(#pendingGradient)"/>
    <text x="255" y="1" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">Pending</text>
  </g>

  <!-- ============== PROGRESS INDICATOR ============== -->
  <g transform="translate(80, 370)">
    <text font-family="Arial, sans-serif" font-size="12" fill="#374151" font-weight="600">Progress:</text>
    <!-- Progress bar background -->
    <rect x="60" y="-12" width="300" height="10" rx="5" fill="#E5E7EB"/>
    <!-- Progress bar fill (animated) -->
    <rect x="60" y="-12" width="180" height="10" rx="5" fill="url(#activeGradient)">
      <animate attributeName="width" values="170;190;170" dur="2s" repeatCount="indefinite"/>
    </rect>
    <!-- Percentage text -->
    <text x="370" y="-3" font-family="Arial, sans-serif" font-size="11" fill="#6B7280" font-weight="600">60%</text>
  </g>

  <!-- ============== METADATA PANELS ============== -->
  <!-- Current Action Detail -->
  <g transform="translate(450, 340)">
    <rect x="0" y="-25" width="280" height="60" rx="8" fill="white" filter="url(#shadow)" stroke="#E5E7EB" stroke-width="1"/>
    <text x="10" y="-8" font-family="Arial, sans-serif" font-size="11" fill="#6B7280" font-weight="600">Current Action:</text>
    <text x="10" y="8" font-family="Arial, sans-serif" font-size="10" fill="#374151">
      Executing web_search for "RAG architectures"
    </text>
    <text x="10" y="23" font-family="Arial, sans-serif" font-size="9" fill="#9CA3AF">
      ‚è± Duration: 2.3s ‚Ä¢ Provider: Tavily
    </text>
  </g>

  <!-- Statistics -->
  <g transform="translate(760, 340)">
    <rect x="0" y="-25" width="200" height="60" rx="8" fill="white" filter="url(#shadow)" stroke="#E5E7EB" stroke-width="1"/>
    <text x="10" y="-8" font-family="Arial, sans-serif" font-size="11" fill="#6B7280" font-weight="600">Session Stats:</text>
    <text x="10" y="8" font-family="Arial, sans-serif" font-size="10" fill="#374151">
      üîß Tools: 3 ‚Ä¢ üíæ Results: 12
    </text>
    <text x="10" y="23" font-family="Arial, sans-serif" font-size="9" fill="#9CA3AF">
      üí∞ Cost: $0.023 ‚Ä¢ ‚ö° Tokens: 1,247
    </text>
  </g>
</svg>
